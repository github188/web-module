package com.ehualu.rise.service.topic;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.inject.Inject;

import com.alibaba.fastjson.JSON;
import com.ehualu.rise.constants.AppConstant;
import com.ehualu.rise.pojo.Head;
import com.ehualu.rise.pojo.topic.Topic;
import com.ehualu.rise.pojo.user.User;
import com.ehualu.rise.service.ServiceInterface;
import com.ehualu.rise.service.user.UserService;

public class TopicManager implements ServiceInterface{

	private UserService userService;
	
	public UserService getUserService() {
		return userService;
	}

	@Inject
	public void setUserService(UserService userService) {
		this.userService = userService;
	}

	@Override
	public Map<String, Object> handle(String head,String body) {
		Head header = JSON.parseObject(head, Head.class);
		if(body == null){
			header.setZtm(AppConstant.ExecuteFlag.BODY_IS_NULL);
			return formatResult(JSON.toJSONString(header), null);
		}
		
		Topic topic = JSON.parseObject(body, Topic.class);
		
		List<Topic> topicList= new ArrayList<Topic>();
		if(topic.getType() == 0){
			Topic topictmp = new Topic();
			topictmp.setId(0);
			topictmp.setCount(topic.getCount());
			topictmp.setType(topic.getType());
			topictmp.setPublishTime(topic.getPublishTime());
			topictmp.setTitle("创新者");
			topictmp.setImageUri("http://10.2.111.238:8080/ehualu-appServer/images/chuangxinzhe.png");
			topictmp.setWebUrl("http://www.ehualu.com/");
			topicList.add(topictmp);
			Topic topictmp1 = new Topic();
			topictmp1.setId(1);
			topictmp1.setCount(topic.getCount());
			topictmp1.setType(topic.getType());
			topictmp1.setPublishTime(topic.getPublishTime());
			topictmp1.setTitle("开拓者");
			topictmp1.setImageUri("http://10.2.111.238:8080/ehualu-appServer/images/kaituozhe.png");
			topictmp1.setWebUrl("http://www.ehualu.com/");
			topicList.add(topictmp1);
			Topic topictmp2 = new Topic();
			topictmp2.setId(2);
			topictmp2.setCount(topic.getCount());
			topictmp2.setType(topic.getType());
			topictmp2.setPublishTime(topic.getPublishTime());
			topictmp2.setTitle("引领者");
			topictmp2.setImageUri("http://10.2.111.238:8080/ehualu-appServer/images/yinlingzhe.png");
			topictmp2.setWebUrl("http://www.ehualu.com/");
			topicList.add(topictmp2);
		}else if(topic.getType() == 1){
			Topic topictmp = new Topic();
			topictmp.setId(3);
			topictmp.setCount(topic.getCount());
			topictmp.setType(topic.getType());
			topictmp.setPublishTime(topic.getPublishTime());
			topictmp.setTitle("有效防止车漆氧化阻隔挥发");
			topictmp.setImageUri("");
			topictmp.setWebUrl("http://weizhang.58.com/zixun/loadinfocontent?infoid=881dcca9-0932-4cbd-b105-ac275b9a12e3");
			topicList.add(topictmp);
			
			Topic topictmp1 = new Topic();
			topictmp1.setId(4);
			topictmp1.setCount(topic.getCount());
			topictmp1.setType(topic.getType());
			topictmp1.setPublishTime(topic.getPublishTime());
			topictmp1.setTitle("让爱车驾驶寿命更长久的妙招");
			topictmp1.setImageUri("");
			topictmp1.setWebUrl("http://weizhang.58.com/zixun/loadinfocontent?infoid=638b4236-9926-4553-abba-5fea4bdbd0d2");
			topicList.add(topictmp1);
			
			Topic topictmp2 = new Topic();
			topictmp2.setId(5);
			topictmp2.setCount(topic.getCount());
			topictmp2.setType(topic.getType());
			topictmp2.setPublishTime(topic.getPublishTime());
			topictmp2.setTitle("有效防止车漆氧化阻隔挥发");
			topictmp2.setImageUri("");
			topictmp2.setWebUrl("http://weizhang.58.com/zixun/loadinfocontent?infoid=881dcca9-0932-4cbd-b105-ac275b9a12e3");
			topicList.add(topictmp2);
			
			Topic topictmp3 = new Topic();
			topictmp3.setId(6);
			topictmp3.setCount(topic.getCount());
			topictmp3.setType(topic.getType());
			topictmp3.setPublishTime(topic.getPublishTime());
			topictmp3.setTitle("让爱车驾驶寿命更长久的妙招");
			topictmp3.setImageUri("");
			topictmp3.setWebUrl("http://weizhang.58.com/zixun/loadinfocontent?infoid=638b4236-9926-4553-abba-5fea4bdbd0d2");
			topicList.add(topictmp3);
		}else{
			Topic topictmp = new Topic();
			topictmp.setId(7);
			topictmp.setCount(topic.getCount());
			topictmp.setType(topic.getType());
			topictmp.setPublishTime(topic.getPublishTime());
			topictmp.setTitle("易华录");
			topictmp.setImageUri("http://10.2.111.238:8080/ehualu-appServer/images/denglu_01.png");
			topictmp.setWebUrl("http://www.ehualu.com/");
			topicList.add(topictmp);
		}
		

//		if(user == null){
//			header.setZtm(AppConstant.Code_01.USER_PWD_IS_WRONG);
//			return formatResult(header, null);
//		}
//		try {
//			if(!usr.getPassword().equals(user.getPassword())){
//				header.setZtm(AppConstant.Code_01.USER_PWD_IS_WRONG);
//				return formatResult(header, null);
//			}
//		} catch (Exception e) {
//			header.setZtm(AppConstant.Code_01.PWD_JIAMI_FAIL);
//			return formatResult(header, null);
//		}
		return formatResult(header, topicList);
	}
	
	public Map<String, Object> formatResult(Object head,Object object){
		Map<String, Object> map = new HashMap<String, Object>();
		map.put(AppConstant.HEAD, head);
		if(object != null){
			map.put(AppConstant.BODY, object);
		}
		return map;
	}

}
